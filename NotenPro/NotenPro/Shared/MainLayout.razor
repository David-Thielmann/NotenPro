@inherits LayoutComponentBase
@using MudBlazor
@using HTLKrems.GradeManagement.Models

<MudThemeProvider Theme="@_theme" />
<MudDialogProvider />
<MudSnackbarProvider />

@if (currentUser == null)
{
    <div>@Body</div>
}
else
{
    @if (currentUser.Role == "Student")
    {
        <MudPaper Class="pa-4 text-center">
            <MudText Typo="Typo.h5">üë®‚Äçüéì Student Layout aktiv</MudText>
            @Body
        </MudPaper>
    }
    else
    {
        <MudLayout>
            <MudAppBar Elevation="1" Color="Color.Primary">
                <MudText Typo="Typo.h6">HTL Krems ‚Äì Notenverwaltung</MudText>
                <MudSpacer />
                <MudIconButton Icon="@Icons.Material.Filled.Logout" OnClick="Logout" />
            </MudAppBar>

            <MudDrawer @bind-Open="_drawerOpen" Elevation="2" Width="220px">
                <MudNavMenu>
                    @if (currentUser.Role == "Teacher")
                    {
                        <MudNavLink Href="/teacher" Icon="@Icons.Material.Filled.School">Lehrer-Dashboard</MudNavLink>
                    }
                    else if (currentUser.Role == "SchoolAdmin")
                    {
                        <MudNavLink Href="/admin" Icon="@Icons.Material.Filled.AdminPanelSettings">Admin-Dashboard</MudNavLink>
                    }
                    else if (currentUser.Role == "SystemAdmin")
                    {
                        <MudNavLink Href="/sysadmin" Icon="@Icons.Material.Filled.Terminal">Sysadmin-Dashboard</MudNavLink>
                    }
                </MudNavMenu>
            </MudDrawer>

            <MudMainContent>
                <MudContainer MaxWidth="MaxWidth.Medium" Class="mt-4">
                    <MudText Typo="Typo.h6" Color="Color.Primary">
                        Willkommen, @currentUser.Name (@currentUser.Role)
                    </MudText>
                    <MudDivider Class="my-2" />
                    @Body
                </MudContainer>
            </MudMainContent>
        </MudLayout>
    }
}

@code {
    private bool _drawerOpen = true;

    private User currentUser = new()
    {
        Name = "Anna Lehrer",
        Email = "teacher@htl-krems.at",
        Role = "Teacher"
    };

    private readonly MudTheme _theme = new()
    {
        PaletteLight = new PaletteLight
        {
            Primary = "#29aae3",
            Background = "#FAFAFA"
        }
    };

    private void Logout()
    {
        currentUser = null;
        StateHasChanged();
    }
}
